---
layout: single
title: 'How to set up #aws #iot #pubsub using #AwsAmplify sdk? '
date: '2018-08-12T21:41:00.001-07:00'
categories: AWS
tags:
- AWS IoT
- AWS Amplify
---

If you are using&nbsp;<a href="https://aws.github.io/aws-amplify/media/api_guide" target="_blank">aws Amplify library</a>&nbsp;(I use 0.4.8 at the moment) in an Angular project&nbsp;and trying to use PubSub&nbsp;module via <a href="https://aws.amazon.com/iot-core/features/" target="_blank">aws IoT</a>, you may want to check out this article on how to configure for PubSub module.<br /><br />There are a few open issues regarding PubSub documentation on Amplify GitHub:<br />1) <a href="https://github.com/aws-amplify/amplify-js/issues/684" target="_blank">Issue 684: Documentation about Pub-Sub Module with AWS IoT</a><br />2) <a href="https://github.com/aws-amplify/amplify-js/issues/781" target="_blank">Issue 781: AWSIoTProvider not connecting</a><br />3) <a href="https://github.com/aws-amplify/amplify-js/issues/749" target="_blank">Issue 749:&nbsp;PubSub &amp; IoT Policy: client connection not authorized if using aws_cognito_identity_pool_id</a><br /><br />If you follow steps on&nbsp;<a href="https://aws-amplify.github.io/amplify-js/media/pub_sub_guide.html" target="_blank">Amplify PubSub document</a>, according to the above issues, there are some additional steps and a typescript type checking issue (that I encountered):<br /><br />To check if your front-end does subscribe to an IoT topic, you can<br />right click &gt; inspect &gt; on browser DevTool, go to Network tab &gt;&nbsp; filter for WS (websockets)<br />then, you should see a websocket connection like the following:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-SuKE_JTIb6Y/W3EDyDVEsII/AAAAAAAAJQ8/l_lyCXTnlB47vp8CTShLSN6J6ZOzXwp8gCK4BGAYYCw/s1600/aws-iot-websocket.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="362" src="https://4.bp.blogspot.com/-SuKE_JTIb6Y/W3EDyDVEsII/AAAAAAAAJQ8/l_lyCXTnlB47vp8CTShLSN6J6ZOzXwp8gCK4BGAYYCw/s640/aws-iot-websocket.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">aws-iot mqtt connection</td></tr></tbody></table><br />Issues that I faced:<br /><h4>Issue 1:</h4>Argument of type '{ aws_pubsub_region: string; aws_pubsub_endpoint: string; }' is not assignable to parameter of type 'MqttProvidertOptions'. Object literal may only specify known properties, and 'aws_pubsub_region' does not exist in type 'MqttProvidertOptions'.<br /><br />This is the code to configure the region and endpoint of AWSIoTProvider<br /><div style="-en-clipboard: true;"></div><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">Amplify.addPluggable(new AWSIoTProvider({</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aws_pubsub_region: '&lt;YOUR-AWS-REGION&gt;',</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aws_pubsub_endpoint: 'wss://xxxxxxxxxxxxx.iot.&lt;YOUR-AWS-REGION&gt;.amazonaws.com/mqtt',</span></div><div><span style="font-family: &quot;monaco&quot;;">}));</span></div></div><div style="-en-clipboard: true;"><br /></div><div style="-en-clipboard: true;">If you see the implementation of&nbsp;<a href="https://github.com/aws-amplify/amplify-js/blob/400b1cb2f393d33efe5aa824f730b3155a2f9822/packages/pubsub/src/Providers/MqttOverWSProvider.ts" target="_blank">MqttOverWSProvider class</a>, MqttOverWSProvider class can be constructed with additional properties not listed in the type MqttProvidertOptions. Strict type checking will complain as&nbsp;aws_pubsub_region and aws_pubsub_endpoint properties can't be found.&nbsp;</div><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">constructor(options: MqttProvidertOptions = {}) {</span></div><div><br style="font-family: Monaco;" /></div><div><span style="font-family: &quot;monaco&quot;;">super({ ...options, clientId: options.clientId || uuid(), });</span></div><div><span style="font-family: &quot;monaco&quot;;">}</span></div></div><br />Solution:<br />in node_modules/aws-amplify/lib/PubSub/Providers/MqttOverWSProvider.d.ts (the file in your node_modules folder)<br /><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">export interface MqttProvidertOptions {</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;clientId?: string;</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;url?: string;</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;[key: string]: any;</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;// aws_pubsub_region?: string;</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;// aws_pubsub_endpoint?: string;</span></div><div><span style="font-family: &quot;monaco&quot;;">}</span></div></div>Reference:<br /><a href="https://stackoverflow.com/questions/42723922/can-you-declare-a-object-literal-type-that-allows-unknown-properties-in-typescri" target="_blank">Can you declare a object literal type that allows unknown properties in typescript?</a>&nbsp;StackOverflow thread<br /><h4>Issue 2:</h4><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="background-color: #fbfaf8; border-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.15); box-sizing: border-box; padding: 8px;"><span style="font-family: &quot;monaco&quot;;"><span style="color: #333333; font-family: &quot;monaco&quot; , &quot;menlo&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace;"><span style="font-size: 12px;">Error: Uncaught (in promise): Object: {"errorCode":7,"errorMessage":"AMQJS0007E Socket error:undefined."}</span></span><br /><br /><span style="color: #333333;"><span style="font-size: 12px;">Error: Uncaught (in promise): Object: {"errorCode":8,"errorMessage":"AMQJS0008I Socket closed."}</span></span></span></div><div><br /></div>Searching around, I arrived at <a href="https://github.com/aws-amplify/amplify-js/issues/781" target="_blank">Amplify issue 781</a>. <br /><br />i) According to GitHub user&nbsp;johnrjj in that thread, you need to include IoT permissions to your Identity Pool users' roles (unauthenticated or / and authenticated roles depending on how you use it). You can then add iot permission to your identity pool roles. With some trials and errors, I found that these are possibly the minimum permissions that you need to subscribe to a topic on your front-end. You can try and let me know if these are enough. You can further find-tune the policy to fit your need.<br /><div style="-en-clipboard: true;"></div><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">{</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;"Version": "2012-10-17",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;"Statement": [</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Sid": "VisualEditor0",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Effect": "Allow",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Action": [</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:Receive",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:UpdateStream",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:CreateStream",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:DeleteStream",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:Subscribe",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:Connect",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"iot:DescribeStream"</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Resource": "*"</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;]</span></div><div><span style="font-family: &quot;monaco&quot;;">}</span></div></div><br />I noticed I only needed to attach IoT Permission to my identity pool principals (users, I think) like what Amplify PubSub document suggests:<br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">aws iot attach-principal-policy --policy-name 'myIOTPolicy' --principal '&lt;YOUR_COGNITO_IDENTITY_ID&gt;'</span></div></div><br /><div style="-en-clipboard: true;">To double check, you may find these <a href="https://docs.aws.amazon.com/cli/latest/reference/iot/index.html#cli-aws-iot" target="_blank">aws iot commands</a> useful. To use these commands, you can this <a href="https://docs.aws.amazon.com/polly/latest/dg/setup-aws-cli.html" target="_blank">aws cli document</a> to set up</div><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="background-color: #fbfaf8; border-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.15); box-sizing: border-box; padding: 8px;"><div style="color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="font-family: &quot;monaco&quot;;">aws iot attach-policy --policy-name 'convertIoT' --target YOUR_IDENTITY_POOL_ID<br /></span></div><div style="color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="font-family: &quot;monaco&quot;;">aws iot list-attached-policies --target&nbsp;</span><span style="font-family: &quot;monaco&quot;;">YOUR_IDENTITY_POOL_ID<br /></span></div><div><span style="color: #333333; font-family: &quot;monaco&quot;; font-size: 12px;">aws iot detach-policy --policy-name YOUR_IOT_POLICY_NAME --target&nbsp;</span><span style="color: #333333; font-family: &quot;monaco&quot;;"><span style="font-size: 12px;">YOUR_IDENTITY_POOL_ID</span></span></div></div><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="background-color: #fbfaf8; border-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.15); box-sizing: border-box; padding: 8px;"><div style="color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="font-family: &quot;monaco&quot;;">aws iot attach-principal-policy --policy-name&nbsp;</span><span style="font-family: &quot;monaco&quot;;">YOUR_IOT_POLICY_NAME</span><span style="font-family: &quot;monaco&quot;;">&nbsp;--pincipal YOUR_COGNITO_IDENTITY_ID</span></div><div><span style="color: #333333; font-family: &quot;monaco&quot;;"><span style="font-size: 12px;">aws iot list-principal-policies --principal&nbsp;</span></span><span style="color: #333333; font-family: &quot;monaco&quot;; font-size: 12px;">YOUR_COGNITO_IDENTITY_ID</span><br /><span style="color: #333333; font-family: &quot;monaco&quot;;"><span style="font-size: 12px;">aws iot detach-principal-policy --policy-name&nbsp;</span></span><span style="color: #333333; font-family: &quot;monaco&quot;; font-size: 12px;">YOUR_IOT_POLICY_NAME</span><span style="color: #333333; font-family: &quot;monaco&quot;;"><span style="font-size: 12px;">&nbsp;--principal&nbsp;</span></span><span style="color: #333333; font-family: &quot;monaco&quot;; font-size: 12px;">YOUR_COGNITO_IDENTITY_ID</span></div></div><br />Edit:<br />Note that list-principal-policies is deprecated. You can use list-attached-policies instead.<br />Check out <a href="https://docs.aws.amazon.com/iot/latest/apireference/API_ListPrincipalPolicies.html" target="_blank">aws list-principal-policies doc</a>&nbsp;and <a href="https://docs.aws.amazon.com/cli/latest/reference/iot/list-principal-policies.html" target="_blank">aws cli list-principal-policies doc</a><br /><br />* All capital case words are placeholders.<br />* YOUR_COGNITO_IDENTITY_ID is a value you can find by opening up your local storage. It is the value for key 'aws.cognito.identity-id.YOUR_IDENTITY_POOL_ID' or you can look it up using the code snippet below (source: <a href="https://aws-amplify.github.io/amplify-js/media/pub_sub_guide.html" target="_blank">Amplify PubSub doc</a>)<br /><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">Auth.currentCredentials().then((info) =&gt; {</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp; const cognitoIdentityId = info._identityId;</span></div><div><span style="font-family: &quot;monaco&quot;;">});</span></div></div><br />Additional:<br />Most probably, you prefer not to attach an IoT policy to your identity pool principals one by one manually. <br /><br />i) You can either write a lambda and have it attach an IoT policy before pubsub is executed. You can then cache the IoT policy attachment record locally so that you don't have to keep invoking the lambda.<br /><br />ii) You can refer <a href="https://gist.github.com/pveller/fc7660bdfaf19eed4b29b2e9415c3917" target="_blank">this code snippet</a> of having the IoT policy attachment code run automatically in the front-end by <a href="https://github.com/aws-amplify/amplify-js/issues/684" target="_blank">pveller in issue #684</a>.<br /><h4>Issue 3:</h4>I noticed it wouldn't work if you attach a policy that allows for resources&nbsp;<span style="background-color: #fbfaf8; color: #333333; font-family: &quot;monaco&quot;; font-size: 12px;">iot:topic/*</span>&nbsp;to your principals.<br /><!--?xml version="1.0" encoding="UTF-8"?-->  <br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">{</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;"Version": "2012-10-17",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;"Statement": [</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Effect": "Allow",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Action": "iot:*",</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Resource": "arn:aws:iot:us-east-1:aws_acc_num:*"</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-family: &quot;monaco&quot;;">&nbsp;&nbsp;]</span></div><div><span style="font-family: &quot;monaco&quot;;">}</span></div></div><br />I think it is because cognito identities aren't resources allowed as they are not topics. If you do it this way -&gt; "Resource": "arn:aws:iot:us-east-1:aws_acc_num:*", it would work.<br />or you can create another policy and attach it to cognito identities.<br /><h4>Issue 4:</h4><a href="https://github.com/aws-amplify/amplify-js/issues/749" target="_blank">Issue 749:&nbsp;PubSub &amp; IoT Policy: client connection not authorized if using aws_cognito_identity_pool_id</a><br />The thread talks about how to configure authorization(IoT permissions) for users.<br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><div><span style="font-family: &quot;monaco&quot;;">Source: 3rd post in the thread by GitHub user - leantide who was in touch with aws support:<br /><br />Answer from AWS Support:</span></div><div><br style="font-family: Monaco;" /></div><div><span style="font-family: &quot;monaco&quot;;">Currently, you need to create a policy for each authenticated Cognito principal, or let all users share the unauthenticated Cognito access (with access defined in your pool policy).</span></div></div><br />Notes:<br />i) MQTT<br /><a href="https://en.wikipedia.org/wiki/MQTT" target="_blank">From Wiki</a>, MQTT (Message Queuing Telemetry Transport) is an ISO standard (ISO/IEC PRF 20922) publish-subscribe-based messaging protocol. It works on top of the TCP/IP protocol.<br /><br />ii) If you use <a href="https://boto3.readthedocs.io/en/latest/reference/services/iot-data.html#IoTDataPlane.Client.publish" target="_blank">IoTDataPlane</a>&nbsp;boto3 client in Python backend / lambda, you may notice this warning:<br /><div style="-en-codeblock: true; background-color: #fbfaf8; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); box-sizing: border-box; color: #333333; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 8px;"><span style="font-family: &quot;monaco&quot;;">/var/runtime/botocore/handlers.py:697: UnsupportedTLSVersionWarning: Currently installed openssl version: OpenSSL 1.0.0-fips 29 Mar 2010 does not support TLS 1.2, which is required for use of iot-data. Please use python installed with openssl version 1.0.1 or higher.</span></div>Apparently, this is a known issue by aws lambda team. Check out this <a href="https://github.com/boto/boto3/issues/1559" target="_blank">aws boto 3 issue 1559</a><br /><br />Additionally, please check out my&nbsp;<a href="https://www.language-diary.com/2018/08/check-out-amazon-echo.html" target="_blank">Amazon Alexa post</a>&nbsp;which I will keep updating after I try out with more Alexa functions. Thanks<br /><br />Thanks for reading!<br /><a href="http://www.language-diary.com/p/jun711-language-diary.html" target="_blank">Jun</a><br /><a href="https://www.amazon.ca/?&amp;_encoding=UTF8&amp;tag=jun7110a-20&amp;linkCode=ur2&amp;linkId=60b74555f1611d644d27d8b13f8b9418&amp;camp=15121&amp;creative=330641" target="_blank">Support me on Amazon</a><br /><br /><br />